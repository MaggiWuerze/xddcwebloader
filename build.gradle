/*
 * This file was generated by the Gradle "init" task.
 */
plugins {
    id 'java'
    id 'maven-publish'
    id 'checkstyle'
    id ("com.github.node-gradle.node") version "3.0.1"
}

repositories {
    mavenCentral()
    maven { url = uri("https://jitpack.io") }
}

node {

}

// VERSIONS
ext {
    SPRING_VERSION = "2.7.18"
    LOMBOK_VERSION = "1.18.30"

}


dependencies {
    //SPRING
    implementation("org.springframework.boot:spring-boot-starter-data-rest:$SPRING_VERSION")
    implementation("org.springframework.boot:spring-boot-starter-security:$SPRING_VERSION")
    implementation("org.springframework.boot:spring-boot-starter-thymeleaf:$SPRING_VERSION")
    implementation("org.springframework.boot:spring-boot-starter-web:$SPRING_VERSION")
    implementation("org.springframework.boot:spring-boot-starter-tomcat:$SPRING_VERSION")
    implementation("org.springframework.boot:spring-boot-starter-data-jpa:$SPRING_VERSION")
    implementation("org.springframework.boot:spring-boot-devtools:$SPRING_VERSION")
    implementation("org.springframework.boot:spring-boot-starter-websocket:$SPRING_VERSION")
    implementation("org.springframework.boot:spring-boot-starter-validation:$SPRING_VERSION")
    testImplementation("org.springframework.boot:spring-boot-starter-test:$SPRING_VERSION")

    //LOMBOK
    compileOnly("org.projectlombok:lombok:$LOMBOK_VERSION")
    annotationProcessor("org.projectlombok:lombok:$LOMBOK_VERSION")
    testCompileOnly("org.projectlombok:lombok:$LOMBOK_VERSION")
    testAnnotationProcessor("org.projectlombok:lombok:$LOMBOK_VERSION")

    //DATABASE
    implementation("org.postgresql:postgresql:42.2.23.jre7")
    implementation("mysql:mysql-connector-java:8.0.25")
    runtimeOnly("com.h2database:h2:1.4.200")

    //XDCC
    implementation("com.github.pircbotx:pircbotx:2.3.1")


    //UTILS
    implementation("commons-io:commons-io:2.11.0")

    //WEBJARS
    implementation("org.webjars:webjars-locator-core:0.48")
    implementation("org.webjars:jquery:3.6.0")
    implementation("org.webjars:bootstrap:5.1.0")
    implementation("org.webjars:font-awesome:5.15.3")

    // JAX-B dependencies for JDK 9+
    implementation "jakarta.xml.bind:jakarta.xml.bind-api:2.3.2"
    implementation "org.glassfish.jaxb:jaxb-runtime:2.3.2"
}

group = "de.maggiwuerze"
description = "xdccloader"
version = "0.5.1-SNAPSHOT"
java.sourceCompatibility = JavaVersion.VERSION_17

publishing {
    publications.create("maven", MavenPublication) {
        from(components["java"])
    }
}

tasks.withType(JavaCompile) {
    options.encoding = "UTF-8"
}

tasks.withType(Checkstyle) {
    reports {
        xml.required = false
        html.required = true
    }
}

task buildReactApp(type: NodeTask, dependsOn: "npmInstall") {
    script = project.file('node_modules/webpack/bin/webpack.js')
    args = [
        '--mode', 'development'
    ]
}

processResources.dependsOn 'buildReactApp'
clean.delete << file('node_modules')
clean.delete << file('src/main/resources/static/built')